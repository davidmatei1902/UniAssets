<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Dashboard - Dotari Universitate</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">

<nav class="navbar navbar-dark bg-dark px-4">
    <a class="navbar-brand" href="#">University Assets Manager</a>
    <a href="/logout" class="btn btn-outline-light btn-sm">Logout</a>
</nav>

<div class="container mt-4">

    <div class="row mb-4">
        <div class="col-md-6">
            <form action="/dashboard" method="get" class="d-flex gap-2">
                <select name="selectedTable" class="form-select" onchange="this.form.submit()">
                    <option value="" disabled selected>-- Selectează Tabelul --</option>
                    <option th:each="t : ${tables}" th:value="${t}" th:text="${t}" th:selected="${t == selectedTable}"></option>
                </select>
            </form>
        </div>
    </div>

    <div th:if="${selectedTable}">
        <ul class="nav nav-tabs" id="myTab" role="tablist">
            <li class="nav-item"><button class="nav-link active" id="view-tab" data-bs-toggle="tab" data-bs-target="#view" type="button">Vizualizare</button></li>
            <li class="nav-item"><button class="nav-link" id="insert-tab" data-bs-toggle="tab" data-bs-target="#insert" type="button">Adăugare</button></li>
            <li class="nav-item"><button class="nav-link" id="delete-tab" data-bs-toggle="tab" data-bs-target="#delete" type="button">Ștergere</button></li>
        </ul>

        <div class="tab-content bg-white p-4 border border-top-0 rounded-bottom">

            <div class="tab-pane fade show active" id="view">
                <h5 class="mb-3">Date din tabelul: <span th:text="${selectedTable}"></span></h5>
                <div class="table-responsive">
                    <table class="table table-striped table-hover">
                        <thead class="table-dark">
                        <tr>
                            <th th:each="colName : ${columns}" th:text="${colName}"></th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr th:each="row : ${tableData}">
                            <td th:each="entry : ${row}" th:text="${entry.value}"></td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="tab-pane fade" id="insert">
                <h5 class="mb-3">Adaugă înregistrare nouă</h5>
                <form action="/insert" method="post">
                    <input type="hidden" name="tableName" th:value="${selectedTable}">

                    <div class="row">
                        <div class="col-md-6 mb-3" th:each="col : ${insertColumns}">
                            <label class="form-label" th:text="${col}"></label>
                            <input type="text" th:name="${col}" class="form-control" placeholder="...">
                        </div>
                    </div>

                    <button type="submit" class="btn btn-success mt-2">Salvează în Baza de Date</button>
                </form>
            </div>

            <div class="tab-pane fade" id="delete">
                <h5 class="mb-3 text-danger">Șterge înregistrare</h5>
                <form action="/delete" method="post" onsubmit="return confirm('Sigur vrei să ștergi?');">
                    <input type="hidden" name="tableName" th:value="${selectedTable}">

                    <div class="mb-3 w-25">
                        <label class="form-label">ID Înregistrare</label>
                        <input type="number" name="id" class="form-control" required>
                    </div>
                    <button type="submit" class="btn btn-danger">Șterge Rândul</button>
                </form>
            </div>

        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>